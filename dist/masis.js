(function(){var t;t=function(){function t(t,e){var r,n,s;return this.options=null!=e?e:{},r=document.querySelectorAll(t),s=[],Array.prototype.forEach.call(r,function(t){return function(e){return s.push(t._init(e))}}(this)),n=s.length,n?1===n?s[0]:void 0:null}return t.prototype._init=function(t){return this.element=t,this.populate()},t}(),this.Masis=t,t.prototype.filter=function(t){var e,r,n,s,l,i;if(null==t&&(t="*"),"*"===t)this.actives=this.children;else{for(r=function(t,e){return(t.matches||t.matchesSelector||t.msMatchesSelector||t.mozMatchesSelector||t.webkitMatchesSelector||t.oMatchesSelector).call(t,e)},n=[],i=this.actives,s=0,l=i.length;l>s;s++)e=i[s],r(e,t)&&n.push(e);this.actives=n}return this.view()},t.prototype.lazy=function(t,e,r){var n,s,l;return null==t&&(t=0),null==e&&(e="data-src"),null==r&&(r=null),l=window.innerHeight||document.documentElement.clientHeight,n=this.element.querySelectorAll("img["+e+"]"),s=function(s){return function(){return n=s.element.querySelectorAll("img["+e+"]"),Array.prototype.forEach.call(n,function(n){var s,i;return s=n.getBoundingClientRect(),-t<=(i=s.top-t)&&l>=i?(n.setAttribute("src",n.getAttribute(e)),n.removeAttribute(e),n.addEventListener("load",function(){return this.style.opacity=1,null!=r?r():void 0},!1)):void 0})}}(this),window.addEventListener("scroll",function(){return s()},!1),s()},t.prototype.populate=function(){var t,e,r,n;for(this.children=[],n=this.element.children,e=0,r=n.length;r>e;e++)t=n[e],8!==t.nodeType&&this.children.push(t);return this.actives=this.children,this.view()},t.prototype.position=function(t){var e,r,n,s,l;for(null==t&&(t={}),null==t.pad&&(t.pad=1),s=parseInt(this.element.offsetWidth),this.element.style.position="relative",e=[],r=l=0;s>=0?s>=l:l>=s;r=s>=0?++l:--l)e[r]=0;return n=function(e,n,s){var l;for(r=0,l=s[e];(r+=t.pad)<n;)l<s[e+r]&&(l=s[e+r]);return l},Array.prototype.forEach.call(this.actives,function(){return function(r){var l,i,o,a,u,h,p,c,d,f,y,v;for(r.style.position="absolute",y=getComputedStyle(r),d=r.getBoundingClientRect(),i=parseInt(d.width)+parseInt(y.marginLeft)+parseInt(y.marginRight),l=parseInt(d.height)+parseInt(y.marginTop)+parseInt(y.marginBottom),h=0,a=0,o=1/0,p=o;s>=a;){for(u=a-t.pad,v=a+i;u++<=v;)c=u+i,s>=c&&(p=l+n(u,i,e),o>p&&(o=p,h=u));a+=i}for(r.style.left=h+"px",r.style.top=o-l+"px",a=i,f=[];a--;)f.push(e[a+h]=o);return f}}(this)),this.element.style.height=Math.max.apply(Math,e)+"px",this},t.prototype.scroll=function(t){var e,r,n,s,l,i,o,a,u,h,p,c,d,f,y,v,g;return null==t&&(t={}),null==t.gutter&&(t.gutter=10),null==t.pad&&(t.pad=10),s=this.element,s.style.position="relative",s.style.overflow="hidden",s.innerHTML='<div class="mscr-content">'+s.innerHTML+"</div>",s.innerHTML+='<div class="mscr-track-h"><div class="mscr-drag-h"/></div>',s.innerHTML+='<div class="mscr-track-v"><div class="mscr-drag-v"/></div>',e=s.querySelector(".mscr-content"),e.style.width=s.offsetWidth+"px",e.style.height=s.offsetHeight+"px",null!=t.width&&(s.style.width=t.width),e.style.position="absolute",e.style.top=e.style.left=0,null!=t.height&&(s.style.height=t.height),p=parseInt(s.offsetWidth)/parseInt(e.offsetWidth),h=parseInt(s.offsetHeight)/parseInt(e.offsetHeight),i=1>p,f=1>h,i&&(c=s.querySelector(".mscr-track-h"),r=s.querySelector(".mscr-drag-h"),c.style.position="absolute",c.style.bottom=c.style.left=0,c.style.height=t.gutter+"px",r.style.position="absolute",r.style.top=r.style.left=0,r.style.height=t.gutter+"px"),f&&(d=s.querySelector(".mscr-track-v"),n=s.querySelector(".mscr-drag-v"),d.style.position="absolute",d.style.top=d.style.right=0,d.style.width=t.gutter+"px",n.style.position="absolute",n.style.top=n.style.left=0,n.style.width=t.gutter+"px"),i&&f&&(p=(parseInt(s.offsetWidth)-t.gutter)/parseInt(e.offsetWidth),h=(parseInt(s.offsetHeight)-t.gutter)/parseInt(e.offsetHeight)),u=null,a=!1,g={X:0,Y:0},document.addEventListener("mouseup",function(t){return t.preventDefault(),a=!1,s.classList.remove("show-scrollbar"),i&&(r.classList.remove("moving"),g.X=parseInt(r.style.left)),f?(n.classList.remove("moving"),g.Y=parseInt(n.style.top)):void 0}),document.addEventListener("mousemove",function(t){return a&&null!=u?o(parseInt(t["page"+a])-parseInt(u["page"+a])):void 0}),v=function(e){return e.preventDefault(),null!=e.originalEvent&&(e=e.originalEvent),s.classList.add("show-scrollbar"),a=e.shiftKey||e.wheelDeltaX?"X":"Y",o(t.pad*((e.wheelDelta||-e.detail)<0?1:-1)),a=!1,s.classList.remove("show-scrollbar"),i&&(g.X=parseInt(r.style.left)),f&&(g.Y=parseInt(n.style.top)),!1},s.addEventListener("mousewheel",v,!1),s.addEventListener("DOMMouseScroll",v,!1),null!=r&&r.addEventListener("mousedown",function(t){return t.preventDefault(),a="X",u=t,s.classList.add("show-scrollbar"),this.classList.add("moving")}),null!=n&&n.addEventListener("mousedown",function(t){return t.preventDefault(),a="Y",u=t,s.classList.add("show-scrollbar"),this.classList.add("moving")}),y=parseInt(s.offsetWidth),l=parseInt(s.offsetHeight),f&&i&&(y-=t.gutter,l-=t.gutter),i&&(c.style.width=y+"px",r.style.width=~~(y*p)+"px"),f&&(d.style.height=l+"px",n.style.height=~~(l*h)+"px"),o=function(t){var s,l,i;return t+=g[a],"X"===a?(s=t,l=parseInt(c.offsetWidth)-parseInt(r.offsetWidth),s>l&&(s=l),0>s&&(s=0),r.style.left=s+"px",e.style.left=~~(-s/p)+"px"):(i=t,l=parseInt(d.offsetHeight)-parseInt(n.offsetHeight),i>l&&(i=l),0>i&&(i=0),n.style.top=i+"px",e.style.top=~~(-i/h)+"px")},this},t.prototype.sort=function(t,e){var r,n,s,l;for(null==t&&(t="text"),null==e&&(e="ASC"),e=e.toUpperCase(),r=Array.prototype.slice.call(this.children,0),r.sort(function(r,n){var s,l,i,o;return l=t.slice(1,-1),i="text"!==t?r.getAttribute(l):r.innerHTML,o="text"!==t?n.getAttribute(l):n.innerHTML,s="ASC"===e?1:-1,null==i&&(i=""),null==o&&(o=""),s*i.localeCompare(o)}),s=0,l=r.length;l>s;s++)n=r[s],this.element.appendChild(n);return this.populate()},t.prototype.view=function(t,e){return null==t&&(t=0),null==e&&(e=0),t=parseInt(t),Array.prototype.forEach.call(this.children,function(t){return t.style.display="none"}),Array.prototype.forEach.call(this.actives,function(){return function(r,n){return!t||t&&n>=e&&t+e>n?r.style.display="":void 0}}(this)),this}}).call(this);