(function(){var t;t=function(){function t(t,e){var r,s,n;return this.options=null!=e?e:{},r=document.querySelectorAll(t),n=[],Array.prototype.forEach.call(r,function(t){return function(e){return n.push(t._init(e))}}(this)),s=n.length,s?1===s?n[0]:void 0:null}return t.prototype._init=function(t){return this.element=t,this.populate()},t}(),this.Masis=t,t.prototype.filter=function(t){var e,r,s,n,i,l,o,a,u;if(null==t&&(t="*"),"*"===t)this.actives=this.children;else{for(n=[],e=this.element.querySelectorAll(t),u=this.actives,i=0,o=u.length;o>i;i++)for(r=u[i],l=0,a=e.length;a>l;l++)if(s=e[l],r===s){n.push(r);break}this.actives=n}return this.view()},t.prototype.lazy=function(t){var e,r,s;return null==t&&(t={}),null==t.threshold&&(t.threshold=0),s=window.innerHeight||document.documentElement.clientHeight,e=this.element.querySelectorAll("img[data-src]"),r=function(r){return function(){return e=r.element.querySelectorAll("img[data-src]"),Array.prototype.forEach.call(e,function(e){var r,n;return r=e.getBoundingClientRect(),0<(n=r.top-t.threshold)&&s>n?(e.setAttribute("src",e.getAttribute("data-src")),e.removeAttribute("data-src"),e.addEventListener("load",function(){return this.style.opacity=1},!1)):void 0})}}(this),window.addEventListener("scroll",function(){return function(){return r()}}(this),!1),r()},t.prototype.populate=function(){var t,e,r,s;for(this.children=[],s=this.element.children,e=0,r=s.length;r>e;e++)t=s[e],8!==t.nodeType&&this.children.push(t);return this.actives=this.children,this.view()},t.prototype.position=function(t){var e,r,s,n,i;for(null==t&&(t={}),null==t.pad&&(t.pad=1),n=parseInt(this.element.offsetWidth),this.element.style.position="relative",e=[],r=i=0;n>=0?n>=i:i>=n;r=n>=0?++i:--i)e[r]=0;return s=function(e,s,n){var i;for(r=0,i=n[e];(r+=t.pad)<s;)i<n[e+r]&&(i=n[e+r]);return i},Array.prototype.forEach.call(this.actives,function(){return function(r){var i,l,o,a,u,h,p,c,d,f,y,v;for(r.style.position="absolute",y=getComputedStyle(r),d=r.getBoundingClientRect(),l=parseInt(d.width)+parseInt(y.marginLeft)+parseInt(y.marginRight),i=parseInt(d.height)+parseInt(y.marginTop)+parseInt(y.marginBottom),h=0,a=0,o=1/0,p=o;n>=a;){for(u=a-t.pad,v=a+l;u++<=v;)c=u+l,n>=c&&(p=i+s(u,l,e),o>p&&(o=p,h=u));a+=l}for(r.style.left=h+"px",r.style.top=o-i+"px",a=l,f=[];a--;)f.push(e[a+h]=o);return f}}(this)),this.element.style.height=Math.max.apply(Math,e)+"px",this},t.prototype.scroll=function(t){var e,r,s,n,i,l,o,a,u,h,p,c,d,f,y,v,g;return null==t&&(t={}),null==t.gutter&&(t.gutter=10),null==t.pad&&(t.pad=10),n=this.element,n.style.position="relative",n.style.overflow="hidden",n.innerHTML='<div class="mscr-content">'+n.innerHTML+"</div>",n.innerHTML+='<div class="mscr-track-h"><div class="mscr-drag-h"/></div>',n.innerHTML+='<div class="mscr-track-v"><div class="mscr-drag-v"/></div>',e=n.querySelector(".mscr-content"),e.style.width=n.offsetWidth+"px",e.style.height=n.offsetHeight+"px",null!=t.width&&(n.style.width=t.width),e.style.position="absolute",e.style.top=e.style.left=0,null!=t.height&&(n.style.height=t.height),p=parseInt(n.offsetWidth)/parseInt(e.offsetWidth),h=parseInt(n.offsetHeight)/parseInt(e.offsetHeight),l=1>p,f=1>h,l&&(c=n.querySelector(".mscr-track-h"),r=n.querySelector(".mscr-drag-h"),c.style.position="absolute",c.style.bottom=c.style.left=0,c.style.height=t.gutter+"px",r.style.position="absolute",r.style.top=r.style.left=0,r.style.height=t.gutter+"px"),f&&(d=n.querySelector(".mscr-track-v"),s=n.querySelector(".mscr-drag-v"),d.style.position="absolute",d.style.top=d.style.right=0,d.style.width=t.gutter+"px",s.style.position="absolute",s.style.top=s.style.left=0,s.style.width=t.gutter+"px"),l&&f&&(p=(parseInt(n.offsetWidth)-t.gutter)/parseInt(e.offsetWidth),h=(parseInt(n.offsetHeight)-t.gutter)/parseInt(e.offsetHeight)),u=null,a=!1,g={X:0,Y:0},document.addEventListener("mouseup",function(t){return t.preventDefault(),a=!1,n.classList.remove("show-scrollbar"),l&&(r.classList.remove("moving"),g.X=parseInt(r.style.left)),f?(s.classList.remove("moving"),g.Y=parseInt(s.style.top)):void 0}),document.addEventListener("mousemove",function(t){return a&&null!=u?o(parseInt(t["page"+a])-parseInt(u["page"+a])):void 0}),v=function(e){return e.preventDefault(),null!=e.originalEvent&&(e=e.originalEvent),n.classList.add("show-scrollbar"),a=e.shiftKey||e.wheelDeltaX?"X":"Y",o(t.pad*((e.wheelDelta||-e.detail)<0?1:-1)),a=!1,n.classList.remove("show-scrollbar"),l&&(g.X=parseInt(r.style.left)),f&&(g.Y=parseInt(s.style.top)),!1},n.addEventListener("mousewheel",v,!1),n.addEventListener("DOMMouseScroll",v,!1),null!=r&&r.addEventListener("mousedown",function(t){return t.preventDefault(),a="X",u=t,n.classList.add("show-scrollbar"),this.classList.add("moving")}),null!=s&&s.addEventListener("mousedown",function(t){return t.preventDefault(),a="Y",u=t,n.classList.add("show-scrollbar"),this.classList.add("moving")}),y=parseInt(n.offsetWidth),i=parseInt(n.offsetHeight),f&&l&&(y-=t.gutter,i-=t.gutter),l&&(c.style.width=y+"px",r.style.width=~~(y*p)+"px"),f&&(d.style.height=i+"px",s.style.height=~~(i*h)+"px"),o=function(t){var n,i,l;return t+=g[a],"X"===a?(n=t,i=parseInt(c.offsetWidth)-parseInt(r.offsetWidth),n>i&&(n=i),0>n&&(n=0),r.style.left=n+"px",e.style.left=~~(-n/p)+"px"):(l=t,i=parseInt(d.offsetHeight)-parseInt(s.offsetHeight),l>i&&(l=i),0>l&&(l=0),s.style.top=l+"px",e.style.top=~~(-l/h)+"px")},this},t.prototype.sort=function(t){var e,r,s,n;s=t[0],n=t[1],null==s&&(s="text"),null==n&&(n="ASC"),n=n.toUpperCase(),"text"!==s&&this.filter(s),e=Array.prototype.slice.call(this.actives,0),e.sort(function(t,e){var r,i,l,o;return i=s.slice(1,-1),l="text"!==s?t.getAttribute(i):t.innerHTML,o="text"!==s?e.getAttribute(i):e.innerHTML,r="ASC"===n?1:-1,r*l.localeCompare(o)});for(r in e)this.element.appendChild(e[r]);return"text"!==s&&this.filter(s),this},t.prototype.view=function(t){return null==t&&(t=0),t=parseInt(t),Array.prototype.forEach.call(this.children,function(t){return t.style.display="none"}),Array.prototype.forEach.call(this.actives,function(e){return function(r,s){return!t||t&&e.current<=s&&s<e.current+t?r.style.display="":void 0}}(this)),this}}).call(this);