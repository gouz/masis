(function(){var t;t=function(){function t(t,e){var r,s,i;return this.options=null!=e?e:{},r=document.querySelectorAll(t),i=[],Array.prototype.forEach.call(r,function(t){return function(e){return i.push(t._init(e))}}(this)),s=i.length,s?1===s?i[0]:void 0:null}return t.prototype._init=function(t){return this.element=t,this.populate()},t}(),this.Masis=t,t.prototype.filter=function(t){var e,r,s,i,n,l,o,a,h;if(null==t&&(t="*"),"*"===t)this.actives=this.children;else{for(i=[],e=this.element.querySelectorAll(t),h=this.actives,n=0,o=h.length;o>n;n++)for(r=h[n],l=0,a=e.length;a>l;l++)if(s=e[l],r===s){i.push(r);break}this.actives=i}return this.view()},t.prototype.populate=function(){var t,e,r,s;for(this.children=[],s=this.element.children,e=0,r=s.length;r>e;e++)t=s[e],8!==t.nodeType&&this.children.push(t);return this.actives=this.children,this.view()},t.prototype.position=function(t){var e,r,s,i,n;for(null==t&&(t={}),null==t.gutter&&(t.gutter=1),i=parseInt(this.element.offsetWidth),this.element.style.position="relative",e=[],r=n=0;i>=0?i>=n:n>=i;r=i>=0?++n:--n)e[r]=0;return s=function(e,s,i){var n;for(r=0,n=i[e];(r+=t.gutter)<s;)n<i[e+r]&&(n=i[e+r]);return n},Array.prototype.forEach.call(this.actives,function(){return function(r){var n,l,o,a,h,u,p,c,f,d,y,v;for(r.style.position="absolute",y=getComputedStyle(r),f=r.getBoundingClientRect(),l=parseInt(f.width)+parseInt(y.marginLeft)+parseInt(y.marginRight),n=parseInt(f.height)+parseInt(y.marginTop)+parseInt(y.marginBottom),u=0,a=0,o=1/0,p=o;i>=a;){for(h=a-t.gutter,v=a+l;h++<=v;)c=h+l,i>=c&&(p=n+s(h,l,e),o>p&&(o=p,u=h));a+=l}for(r.style.left=u+"px",r.style.top=o-n+"px",a=l,d=[];a--;)d.push(e[a+u]=o);return d}}(this)),this.element.style.height=Math.max.apply(Math,e)+"px",this},t.prototype.scroll=function(t){var e,r,s,i,n,l,o,a,h,u,p,c,f,d,y;return null==t&&(t={}),"redraw"===t?(this.scroll_redraw(),this):(null==t.gutter&&(t.gutter=10),null==t.pad&&(t.pad=10),i=this.element,i.style.position="relative",i.style.overflow="hidden",i.innerHTML='<div class="mscr-content">'+i.innerHTML+"</div>",i.innerHTML+='<div class="mscr-track-h"><div class="mscr-drag-h"/></div>',i.innerHTML+='<div class="mscr-track-v"><div class="mscr-drag-v"/></div>',e=i.querySelector(".mscr-content"),e.style.width=i.offsetWidth+"px",e.style.height=i.offsetHeight+"px",null!=t.width&&(i.style.width=t.width),e.style.position="absolute",e.style.top=e.style.left=0,null!=t.height&&(i.style.height=t.height),u=parseInt(i.offsetWidth)/parseInt(e.offsetWidth),h=parseInt(i.offsetHeight)/parseInt(e.offsetHeight),n=1>u,f=1>h,n&&(p=i.querySelector(".mscr-track-h"),r=i.querySelector(".mscr-drag-h"),p.style.position="absolute",p.style.bottom=p.style.left=0,p.style.height=t.gutter+"px",r.style.position="absolute",r.style.top=r.style.left=0,r.style.height=t.gutter+"px"),f&&(c=i.querySelector(".mscr-track-v"),s=i.querySelector(".mscr-drag-v"),c.style.position="absolute",c.style.top=c.style.right=0,c.style.width=t.gutter+"px",s.style.position="absolute",s.style.top=s.style.left=0,s.style.width=t.gutter+"px"),n&&f&&(u=(parseInt(i.offsetWidth)-t.gutter)/parseInt(e.offsetWidth),h=(parseInt(i.offsetHeight)-t.gutter)/parseInt(e.offsetHeight)),a=null,o=!1,y={X:0,Y:0},document.addEventListener("mouseup",function(t){return t.preventDefault(),o=!1,i.classList.remove("show-scrollbar"),n&&(r.classList.remove("moving"),y.X=parseInt(r.style.left)),f?(s.classList.remove("moving"),y.Y=parseInt(s.style.top)):void 0}),document.addEventListener("mousemove",function(t){return o&&null!=a?l(parseInt(t["page"+o])-parseInt(a["page"+o])):void 0}),d=function(e){return null!=e.originalEvent&&(e=e.originalEvent),i.classList.add("show-scrollbar"),o=e.shiftKey||e.wheelDeltaX?"X":"Y",l(t.pad*((e.wheelDelta||-e.detail)<0?1:-1)),o=!1,i.classList.remove("show-scrollbar"),n&&(y.X=parseInt(r.style.left)),f?y.Y=parseInt(s.style.top):void 0},i.addEventListener("mousewheel",d,!1),i.addEventListener("DOMMouseScroll",d,!1),null!=r&&r.addEventListener("mousedown",function(t){return t.preventDefault(),o="X",a=t,i.classList.add("show-scrollbar"),this.classList.add("moving")}),null!=s&&s.addEventListener("mousedown",function(t){return t.preventDefault(),o="Y",a=t,i.classList.add("show-scrollbar"),this.classList.add("moving")}),this.scroll_redraw=function(){var e,l;return l=parseInt(i.offsetWidth),e=parseInt(i.offsetHeight),f&&n&&(l-=t.gutter,e-=t.gutter),n&&(p.style.width=l+"px",r.style.width=~~(l*u)+"px"),f?(c.style.height=e+"px",s.style.height=~~(e*h)+"px"):void 0},this.scroll_redraw(),l=function(t){var i,n,l;return t+=y[o],"X"===o?(i=t,n=parseInt(p.offsetWidth)-parseInt(r.offsetWidth),i>n&&(i=n),0>i&&(i=0),r.style.left=i+"px",e.style.left=~~(-i/u)+"px"):(l=t,n=parseInt(c.offsetHeight)-parseInt(s.offsetHeight),l>n&&(l=n),0>l&&(l=0),s.style.top=l+"px",e.style.top=~~(-l/h)+"px")},this)},t.prototype.sort=function(t){var e,r,s,i;s=t[0],i=t[1],null==s&&(s="text"),null==i&&(i="ASC"),i=i.toUpperCase(),"text"!==s&&this.filter(s),e=Array.prototype.slice.call(this.actives,0),e.sort(function(t,e){var r,n,l,o;return n=s.slice(1,-1),l="text"!==s?t.getAttribute(n):t.innerHTML,o="text"!==s?e.getAttribute(n):e.innerHTML,r="ASC"===i?1:-1,r*l.localeCompare(o)});for(r in e)this.element.appendChild(e[r]);return"text"!==s&&this.filter(s),this},t.prototype.view=function(t){return null==t&&(t=0),t=parseInt(t),Array.prototype.forEach.call(this.children,function(t){return t.style.display="none"}),Array.prototype.forEach.call(this.actives,function(e){return function(r,s){return!t||t&&e.current<=s&&s<e.current+t?r.style.display="":void 0}}(this)),this}}).call(this);