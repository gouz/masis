(function(){var t;t=function(){function t(t,e){var s,r,n;return this.options=null!=e?e:{},s=document.querySelectorAll(t),n=[],Array.prototype.forEach.call(s,function(t){return function(e){return n.push(t._init(e))}}(this)),r=n.length,r?1===r?n[0]:void 0:null}return t.prototype._init=function(t){return this.element=t,this.populate()},t}(),this.Masis=t,t.prototype.filter=function(t){var e,s,r,n,i,l,o,a,h;if(null==t&&(t="*"),"*"===t)this.actives=this.children;else{for(n=[],e=this.element.querySelectorAll(t),h=this.actives,i=0,o=h.length;o>i;i++)for(s=h[i],l=0,a=e.length;a>l;l++)if(r=e[l],s===r){n.push(s);break}this.actives=n}return this.view()},t.prototype.populate=function(){var t,e,s,r;for(this.children=[],r=this.element.children,e=0,s=r.length;s>e;e++)t=r[e],8!==t.nodeType&&this.children.push(t);return this.actives=this.children,this.view()},t.prototype.position=function(t){var e,s,r,n,i;for(null==t&&(t={}),null==t.gutter&&(t.gutter=1),n=parseInt(this.element.offsetWidth),this.element.style.position="relative",e=[],s=i=0;n>=0?n>=i:i>=n;s=n>=0?++i:--i)e[s]=0;return r=function(e,r,n){var i;for(s=0,i=n[e];(s+=t.gutter)<r;)i<n[e+s]&&(i=n[e+s]);return i},Array.prototype.forEach.call(this.actives,function(){return function(s){var i,l,o,a,h,u,p,c,f,d,y,v;for(s.style.position="absolute",y=getComputedStyle(s),f=s.getBoundingClientRect(),l=parseInt(f.width+parseInt(y.marginLeft+parseInt(y.marginRight))),i=parseInt(f.height+parseInt(y.marginTop+parseInt(y.marginBottom))),u=0,a=0,o=1/0,p=o;n>=a;){for(h=a-t.gutter,v=a+l;h++<=v;)c=h+l,n>=c&&(p=i+r(h,l,e),o>p&&(o=p,u=h));a+=l}for(s.style.left=u+"px",s.style.top=o-i+"px",a=l,d=[];a--;)d.push(e[a+u]=o);return d}}(this)),this.element.style.height=Math.max.apply(Math,e)+"px",this},t.prototype.scroll=function(t){var e,s,r,n,i,l,o,a,h,u,p,c,f,d;return null==t&&(t={}),"redraw"===t?(this.scroll_redraw(),this):(null==t.gutter&&(t.gutter=10),null==t.pad&&(t.pad=10),n=this.element,n.style.position="relative",n.style.overflow="hidden",n.innerHTML='<div class="mscr-content">'+n.innerHTML+"</div>",n.innerHTML+='<div class="mscr-track-h"><div class="mscr-drag-h"/></div>',n.innerHTML+='<div class="mscr-track-v"><div class="mscr-drag-v"/></div>',e=n.querySelector(".mscr-content"),e.style.width=n.offsetWidth+"px",e.style.height=n.offsetHeight+"px",null!=t.width&&(n.style.width=t.width),e.style.position="absolute",e.style.top=e.style.left=0,null!=t.height&&(n.style.height=t.height),u=parseInt(n.offsetWidth)/parseInt(e.offsetWidth),h=parseInt(n.offsetHeight)/parseInt(e.offsetHeight),i=1>u,f=1>h,i&&(p=n.querySelector(".mscr-track-h"),s=n.querySelector(".mscr-drag-h"),p.style.position="absolute",p.style.bottom=p.style.left=0,p.style.height=t.gutter+"px",s.style.position="absolute",s.style.top=s.style.left=0,s.style.height=t.gutter+"px"),f&&(c=n.querySelector(".mscr-track-v"),r=n.querySelector(".mscr-drag-v"),c.style.position="absolute",c.style.top=c.style.right=0,c.style.width=t.gutter+"px",r.style.position="absolute",r.style.top=r.style.left=0,r.style.width=t.gutter+"px"),i&&f&&(u=(parseInt(n.offsetWidth)-t.gutter)/parseInt(e.offsetWidth),h=(parseInt(n.offsetHeight)-t.gutter)/parseInt(e.offsetHeight)),a=null,o=!1,d={X:0,Y:0},document.addEventListener("mouseup",function(t){return t.preventDefault(),o=!1,n.classList.remove("show-scrollbar"),i&&(s.classList.remove("moving"),d.X=parseInt(s.style.left)),f?(r.classList.remove("moving"),d.Y=parseInt(r.style.top)):void 0}),document.addEventListener("mousemove",function(t){return o&&null!=a?l(parseInt(t["page"+o])-parseInt(a["page"+o])):void 0}),n.addEventListener("mousewheel",function(e){return null!=e.originalEvent&&(e=e.originalEvent),n.classList.add("show-scrollbar"),o=e.shiftKey||e.wheelDeltaX?"X":"Y",l(t.pad*(e.wheelDelta<0?1:-1)),o=!1,n.classList.remove("show-scrollbar"),i&&(d.X=parseInt(s.style.left)),f?d.Y=parseInt(r.style.top):void 0}),n.addEventListener("DOMMouseScroll",function(e){return null!=e.originalEvent&&(e=e.originalEvent),n.classList.add("show-scrollbar"),o=e.shiftKey?"X":"Y",l(t.pad*(-e.detail<0?1:-1)),o=!1,n.classList.remove("show-scrollbar"),i&&(d.X=parseInt(s.style.left)),f?d.Y=parseInt(r.style.top):void 0}),null!=s&&s.addEventListener("mousedown",function(t){return t.preventDefault(),o="X",a=t,n.classList.add("show-scrollbar"),this.classList.add("moving")}),null!=r&&r.addEventListener("mousedown",function(t){return t.preventDefault(),o="Y",a=t,n.classList.add("show-scrollbar"),this.classList.add("moving")}),this.scroll_redraw=function(){var e,l;return l=parseInt(n.offsetWidth),e=parseInt(n.offsetHeight),f&&i&&(l-=t.gutter,e-=t.gutter),i&&(p.style.width=l+"px",s.style.width=~~(l*u)+"px"),f?(c.style.height=e+"px",r.style.height=~~(e*h)+"px"):void 0},this.scroll_redraw(),l=function(t){var n,i,l;return t+=d[o],"X"===o?(n=t,i=parseInt(p.offsetWidth)-parseInt(s.offsetWidth),n>i&&(n=i),0>n&&(n=0),s.style.left=n+"px",e.style.left=~~(-n/u)+"px"):(l=t,i=parseInt(c.offsetHeight)-parseInt(r.offsetHeight),l>i&&(l=i),0>l&&(l=0),r.style.top=l+"px",e.style.top=~~(-l/h)+"px")},this)},t.prototype.sort=function(t){var e,s,r,n;r=t[0],n=t[1],null==r&&(r="text"),null==n&&(n="ASC"),n=n.toUpperCase(),"text"!==r&&this.filter(r),e=Array.prototype.slice.call(this.actives,0),e.sort(function(t,e){var s,i,l,o;return i=r.slice(1,-1),l="text"!==r?t.getAttribute(i):t.innerHTML,o="text"!==r?e.getAttribute(i):e.innerHTML,s="ASC"===n?1:-1,s*l.localeCompare(o)});for(s in e)this.element.appendChild(e[s]);return"text"!==r&&this.filter(r),this},t.prototype.view=function(t){return null==t&&(t=0),t=parseInt(t),Array.prototype.forEach.call(this.children,function(t){return t.style.display="none"}),Array.prototype.forEach.call(this.actives,function(e){return function(s,r){return!t||t&&e.current<=r&&r<e.current+t?s.style.display="":void 0}}(this)),this}}).call(this);